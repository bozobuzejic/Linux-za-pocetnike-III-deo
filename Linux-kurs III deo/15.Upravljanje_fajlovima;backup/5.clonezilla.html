<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title></title></head><body><p>1.CLONEZILLA </p>

<p>Clonezilla je aplikacija koja klonira sistem, pravi potpunu kopiju sistema (backup system)</p>

<pre><code>   Primer rađen na XUbuntu u VirtualBox-u

   cd /home/bozobuzejic/Downloads/
   wget https://osdn.net/projects/clonezilla/downloads/71567/clonezilla-live-20190903-disco-amd64.iso      .....downloadujemo clonezilla iso fajl

   VirtalBox -&gt; XUbuntu -&gt; Settings -&gt; Storage -&gt; Adds new storage controller -&gt; Add SAS controller -&gt; Adds hard disk -&gt; Create new disk -&gt; VMDK -&gt; Next -&gt;
   -&gt; Dynamically allocated -&gt; Next -&gt; /___/___/___/XUbuntu/NewVirtualDisk.vmdk  ; 20GB  -&gt; Create -&gt; OK


   VirtalBox -&gt; XUbuntu -&gt; Start -&gt;  pokrenemo terminal:

                lsblk                                                                .....učitamo spisak diskova u sistemu
                sudo fdisk /dev/sdc                                                  .....ulazimo u program fdisk da kreiramo particiju od novog diska (sdc)

                                     n        enter                                       .....pokrećemo kreiranje particije
                                     default:   p  / (e) enter                            .....po defaultu kreiramo primarnu particiju 
                                     1        enter                                       .....biramo ponuđen (1) ako je disk prazan ili neki drugi broj 
                                     first sector:   default  enter                       .....biramo početni sektor koji je ponuđen po defaultu 
                                     last sector:    default  enter                       .....određujemo kraj particije 
                                     w        enter                                       .....upisuju se promene na disku 
                                     y        enter                                       .....potvrdjujemo promene i izlazimo
                lsblk                     
                mkfs.ext4 /dev/sdc1                                                  .....formatiramo kreiranu particiju (sdc1) u ext4 fajl
                poweroff                                                             .....isključimo sistem (XUbuntu)


   Backup (izrada klona):

   VirtalBox -&gt; XUbuntu -&gt; Settings -&gt; Storage -&gt;  Controller IDE -&gt; Empty -&gt; Chose virtual optical disk file -&gt; 
   -&gt; /home/bozobuzejic/Downloads/clonezilla-live-20190903-disco-amd64.iso -&gt; OK -&gt; Start (pokrećemo XUbuntu - diže se clonizella iso fajl -&gt;
   -&gt; izabrati jezik (ostati na ponuđenom - en_us.UTF8) -&gt; konfigurisati tastaturu (ostaviti sistemsku): keep... -&gt; Start Clonezilla -&gt;
   -&gt; device-image -&gt; Use local device -&gt; enter -&gt; Enter -&gt; ctrl + c -&gt; sdc1 20G_ext4(In_HARDDISK_)... -&gt; ne dirati označeno -&gt; tab -&gt; tab -&gt;
   -&gt; Done -&gt; enter -&gt; Enter -&gt; Expert mode -&gt; savedisk (Save_local_disk_as_an_image) -&gt; upisati: XUbuntu_img -&gt; izabrati - čekirati source disk (onaj koji 
      kloniramo): sdb........ -&gt; q2 Priority: partclone... -&gt; ništa ne menjamo: enter -&gt; z1 gzip compression -&gt; ostavljamo ponuđeno: 4096 -&gt; 
   -&gt; SFSCK (Skip checking source file system) -&gt; scs No, skip checking..... -&gt; senc Not to ecrypt the image -&gt;  p Poweroff -&gt; Enter -&gt; y -&gt; enter -&gt; enter


   Restore image:

   VirtalBox -&gt; XUbuntu -&gt; Settings -&gt; Storage -&gt;  Controller IDE -&gt; Empty -&gt; Chose virtual optical disk file -&gt; 
   -&gt; /home/bozobuzejic/Downloads/clonezilla-live-20190903-disco-amd64.iso -&gt; OK -&gt; Start (pokrećemo XUbuntu - diže se clonizella iso fajl -&gt;
   -&gt; izabrati jezik (ostati na ponuđenom - en_us.UTF8) -&gt; konfigurisati tastaturu (ostaviti sistemsku): keep... -&gt; Start Clonezilla -&gt; 
   -&gt; device-image -&gt; Use local device -&gt; enter -&gt; Enter -&gt; ctrl + c -&gt; sdc1 20G_ext4(In_HARDDISK_)... -&gt; ne dirati označeno -&gt; tab -&gt; tab -&gt;
   -&gt; Done -&gt; enter -&gt; Enter -&gt; Expert mode -&gt; restoredisk (Restore_an_image_to_local_disk) -&gt; Choise the image file to restore: XUbuntu_img -&gt;
   -&gt; Choose the target disk: sdb 22.3GB..... -&gt; odčekirati g auto Reinstall grub.... -&gt; Use partition table from the image -&gt; scr No, skip checking..... -&gt;
   -&gt; p Poweroff -&gt; Enter -&gt; y -&gt; enter -&gt; y -&gt; enter -&gt; enter 
</code></pre>

<hr>

<p>Clonezilla omogućuje kreiranje kloniranih sistema i na mreži</p>

<p>Kloniranje sistema klijenta (CentOS7) na server (Debian10) i restore sistema na jednom ili više klijenata (CentOS7-1, CentOS7-2&hellip;) u mreži, putem ssh servisa</p>

<p>*Kreirnje klon-slike klijenta CentOS7 na server Debian10 (u okviru iste mreže putem ssh servisa):</p>

<pre><code>CD/USB Boot enabled in the BIOS                                                             .....podesimo da se klijent podiže sa usb-a ili cd-a
ili
VirtalBox -&gt; CentOS7 -&gt; Settings -&gt; Storage -&gt;  Controller IDE -&gt; Empty -&gt; Chose virtual optical disk file -&gt; 
          -&gt; /home/bozobuzejic/Downloads/clonezilla-live-20190903-disco-amd64.iso -&gt; OK 

VirtalBox -&gt; CentOS7 -&gt; Start (pokrećemo CentOS7 - diže se clonizella iso fajl) -&gt; izabrati jezik (ostati na ponuđenom - en_us.UTF8) -&gt; 
          -&gt; konfigurisati tastaturu (ostaviti sistemsku): keep... -&gt; Start Clonezilla -&gt; device-image -&gt; ssh_server -&gt; DHCP -&gt; 
          -&gt; 192.168.0.200 (IP adresa računara na koji šaljemo image) -&gt; 22 (port za ssh) -&gt; bozo (username ciljanog računara) -&gt; 
          -&gt; debianbb (hostname ciljanog računara) -&gt; /home/bozo/imeges (upišemo putanju do direktorijuma za smeštaj klon-slike na serveru) -&gt; ok -&gt; yes -&gt;
          -&gt; password (password za bozo - korisnika ciljnog računara) -&gt; enter -&gt; Beginner mode -&gt; savedisk -&gt; 2021-01-31-17-img (naziv image fajla) -&gt; 
          -&gt; obeležimo source hard drive (disk koji kloniramo) -&gt; z1p -&gt; skip checking file system -&gt; skip checking the saved image -&gt; not encrypt the image -&gt; 
          -&gt; poweroff (klijent će se isključiti kad se završi kloniranje) -&gt; enter -&gt; y
</code></pre>

<p>*Pokretanje i vraćanje kloniranog sistema (CentOS7) sa servera (Debian10) na klijente (CentOS7-1, CentOS7-2&hellip;) </p>

<p>-Primer 1 (svaku od mašina pojedinačno povezujemo sa serverom i s njega povlačimo clon-image fajl i instaliramo ga na toj mašini):</p>

<pre><code>CD/USB Boot enabled in the BIOS                                                             .....podesimo da se klijent podiže sa usb-a ili cd-a
ili
VirtalBox -&gt; New -&gt; CentOS7-1 -&gt; Memory size: 1024 -&gt; Next -&gt; Create a virtual hard disk now -&gt; Create -&gt;  VDI -&gt; Next -&gt; Dinamically allocated -&gt; Next -&gt;
          -&gt; File location and size: 25,93 GB -&gt; Create

VirtalBox -&gt; CentOS7-1 -&gt; Settings -&gt; Storage -&gt; Network -&gt; Adapter 1 -&gt; Atached to: Bridged Adapter -&gt; Promiscuous mode: Alow all -&gt; 
          -&gt; Advanceed: Cable connected -&gt; Ok
VirtalBox -&gt; CentOS7-1 -&gt; Settings -&gt; Storage -&gt;  Controller IDE -&gt; Empty -&gt; Chose virtual optical disk file -&gt; 
          -&gt; /home/bozobuzejic/Downloads/clonezilla-live-20190903-disco-amd64.iso -&gt; OK           
VirtalBox -&gt; CentOS7-1 -&gt; Start (pokrećemo CentOS7-1 - diže se clonizella iso fajl) -&gt; Clonizzella live -&gt; izabrati jezik (ostati na ponuđenom - en_us.UTF8) -&gt;           
          -&gt; konfigurisati tastaturu (ostaviti sistemsku): keep... -&gt; Start Clonezilla -&gt; device-image -&gt; ssh_server -&gt; DHCP default -&gt; 
          -&gt; 192.168.0.200 (IP adresa računara sa koga šaljemo image) -&gt; 22 (port za ssh) -&gt; bozo (username ciljanog računara) -&gt;
          -&gt; /home/bozo/imeges (upišemo putanju do direktorijuma na serveru sa koga šaljemo image (u kome je ranije snimljena klon-slika)) -&gt; ok -&gt; yes -&gt; 
          -&gt; password (password za bozo - korisnika servera) -&gt; enter -&gt; Beginner mode -&gt; restoredisk -&gt; 2021-01-31-17-img (naziv image fajla) -&gt; 
          -&gt; obeležimo sda - source hard drive (disk na kome je klon-slika) -&gt; sda - obeležimo i odaberemo ciljni hard disk na koju ćemo instalirati klona -&gt; 
          -&gt; skip checking image... -&gt; poweroff (klijent će se isključiti kad se završi kloniranje) -&gt; enter -&gt; y -&gt; y


Napomena: Na ovaj način možemo konfigurisati i pokrenuti kloniranje na više mašina u isto vreme s tim da se svaka mašina pojedinačno mora pokrenuti
          sa clonezilla-live-20190903-disco-amd64.iso i biti u istoja mreži u kojoj je server
</code></pre>

<p>-Primer 2 (sa neke mašine pokrenemo postupak da se sve mašine pojedinačno, automatski povezuju sa serverom koji otprema clon-image fajl i instalira ga na njima):</p>

<pre><code>° Priprema servera sa koga se vrši restore kloniranog sistema na druge mašine

CD/USB Boot enabled in the BIOS                                                             .....podesimo da se klijent podiže sa usb-a ili cd-a
ili
VirtalBox -&gt; CentOS7 -&gt; Settings -&gt; Storage -&gt; Network -&gt; Adapter 1 -&gt; Atached to: Bridged Adapter -&gt; Promiscuous mode: Alow all -&gt; 
          -&gt; Advanceed: Cable connected -&gt; Ok
VirtalBox -&gt; CentOS7 -&gt; Settings -&gt; Storage -&gt;  Controller IDE -&gt; Empty -&gt; Chose virtual optical disk file -&gt; 
          -&gt; /home/bozobuzejic/Downloads/clonezilla-live-20190903-disco-amd64.iso -&gt; OK 
VirtalBox -&gt; CentOS7 -&gt; Start (pokrećemo CentOS7 - diže se clonizella iso fajl) -&gt; Clonizzella live -&gt; izabrati jezik (ostati na ponuđenom - en_us.UTF8) -&gt; 
          -&gt; konfigurisati tastaturu (ostaviti sistemsku): keep... -&gt; Start Clonezilla -&gt; lite-server -&gt; start Clonezilla lite server -&gt; netboot -&gt; 
          -&gt; auto detect DHCP... -&gt; Y -&gt; ssh_server -&gt; 192.168.0.200 (IP adresa servera sa koga šaljemo image) -&gt; 22 (port za ssh) -&gt; bozo (user sa servera) -&gt; 
          -&gt; /home/bozo/imeges (upišemo putanju do direktorijuma gde je smeštna klon-slike na serveru) -&gt; ok -&gt; y -&gt; yes -&gt;
          -&gt; password (password za korisnika servera) -&gt; enter -&gt; Beginner mode -&gt; massive-deployment -&gt; from-image -&gt; restoredisk -&gt; 
          -&gt; 2021-01-31-17-img izaberemo klon-sliku (source image) -&gt; sda - obeležimo i odaberemo ciljni hard disk -&gt; skip checking image... -&gt;
          -&gt; poweroff -&gt;  multicast -&gt; client-to-wait -&gt; 2 (odredimo da će se slika sistema instalirati na 2 računara).....kad se završe sve instalacije: Y

° Pokretanje klijenata na koje se vrši instaliranje klonova

VirtalBox -&gt; CentOS7-1 (CentOS7-2...) -&gt; Clonezilla live lite client: restore 2021-01-31-17-img
</code></pre>

<hr>

<p>*Konfiguracija Clonezilla servera (DRBL server)</p>

<p>Primer rađen na Debian 10 sistemu u VirtualBox-u</p>

<pre><code>sudo vim /etc/apt/sources.list                                                            .....otvorimo fajl sa listom linkova ka repozitorijumima
     deb http://ftp.us.debian.org/debian buster main                                           i dodamo dve linije
     deb http://free.nchc.org.tw/drbl-core/ drbl stable

wget http://drbl.sourceforge.net/GPG-KEY-DRBL                                             .....downloadujemo ključ za drbl (Diskless Remote Boot in Linux)
sudo apt-key add GPG-KEY-DRBL                                                             .....dodamo ključ GPG-KEY-DRBL na sistem
sudo apt-get update                                                                       .....apdejtujemo sistem

sudo vim /etc/network/interfaces.d/setup                                                  .....konfigurišemo statičku IP adresu drbl servera
     auto lo
     iface lo inet loopback

     auto enp0s3                                                                               .....statička adresa sa kojom server izlazi na internet
     iface enp0s3 inet static
     address 192.168.0.200
     netmask 255.255.255.0
     gateway 192.168.0.1

     auto enp0s8                                                                               .....statička adresa servera preko koje sa dhcp podešavanjima
     iface enp0s8 inet static                                                                       server određuje adrese mašina u loklanoj mreži
     address 192.168.99.200
     netmask 255.255.255.0

sudo vim /etc/resolve.conf                                                                .....uredimo /etc/resolve.conf za pristup servera googlovim serverima
     nameserver 8.8.8.8                                                                        
     nameserver 4.4.4.4
     nameserver 127.0.0.1

sudo apt-get install drbl                                                                 .....instaliramo Diskless Remote Boot in Linux

sudo drblsrv -i                                                                           .....u interaktivnom meniju podesimo ponašanje servera
    Y (to install the network installation boot images)
    N (to skip serial console output)
    Y (to update the Operating System)
    2 (or whichever kernel is later)

sudo drblpush -i                                                                          .....pokrenemo drbl skriptu i u interaktivnom meniju izvršimo dalja 
    enter                                                                                      podešavanja
    enter
    enter
    enp0s3  (whichever NIC leads to the Internet) 
    N (to Collecting MAC Addresses)
    N (to letting the DHCP service in DRBL offer the same IP address)
    1 (initial number do you want to use in the last set of digits in the IP)
    10 (Select the number of DRBL (Clonezilla client) systems expected)                   .....odredimo broj sistema koje ćemo klonirati na server
    Y (to confirm the IP address settings on enp0s8)
    enter (key to confirm IP setup of DRBL) 
    1 (for DRBL Single system image (SSI)
    1 (for Clonezilla Box mode)
    /home/partimag  (select a location to store images)
    Y (to create a swap partition)
    128 (for the swap size)
    1 (for Graphic Mode)
    0 (for Normal Login)
    N (to skip setting the root password on clients)
    N (to skip a PXE boot password)
    Y (to set the boot prompt for client)
    70 (as the boot prompt timeout)
    Y (to use graphics background) 
    Y (to allow audio, CD-ROM, floppy, video, etc..)
    N (for public IPs for clients)
    Y (to allow terminal mode)
    Y (to run DRBL as a NAT Server) 
    enter (to continue)
    Y (to overwrite firewall rules)


sudo systemctl stop dnsmasq
sudo systemctl disable dnsmasq
sudo systemctl start isc-dhcp-server 
sudo systemctl enable isc-dhcp-server
sudo systemctl start tftpd-hpa
sudo systemctl enable tftpd-hpa                                                              .....onemogućimo dnsmasq servis a omogućimo dhcp i tftp servise
                                                                                                  i pokrenemo ih

sudo ufw allow 21
sudo ufw allow 22
sudo ufw allow 53
sudo ufw allow 53
sudo ufw allow 67
sudo ufw allow 69
sudo ufw allow 4011
sudo systemctl reload ufw                                                                    .....omogućimo portve na serveru za navedene servise                                 
</code></pre>

<p>*Pokretanje servisa:</p>

<pre><code>sudo dcs                                                                                     .....startujemo clonezillu
    Select all the clients
    Clonezilla-start
    Beginner mode
    select-in-client
    y1 Server always provides clone mode -  default Clonezilla
    -p choose Choose in client when the clone finishes

sudo reboot                                                                                  .....restartujemo server
</code></pre>

<p>*Konfiguracija klijenta i pokretanje izrade klona sistema sa klijenta: 
 Primer rađen sa CenOS 7 u VirtualBox-u kao klijentom</p>

<pre><code>PXE Boot enabled in the BIOS                                                                 .....podesimo da se klijenti podižu sa mreže
ili
VirtualBox -&gt; CentOS 7 -&gt; Settings -&gt; System -&gt; Boot order: čekirati Network, odčekirati ostalo -&gt; 
           -&gt; Preferences -&gt; Network -&gt; Adds news NAT network -&gt; čekiramo Enable network -&gt; Network name: neta -&gt; Netvork CIDR: 192.168.99.0/24 -&gt;
           -&gt; Network options: čekiramo Supports DHCP Network -&gt; Ok 
           -&gt; Settings -&gt; -&gt; Network -&gt; Attached to: Internal network -&gt; neta -&gt; Promiscuous mode: Alow all -&gt; OK 

Clonezilla (from the boot option list)
    device-image option 
    Beginner
    save disk option 
    Type a name of your choice for the image                                                .....zadržimo predložen naziv klon-slike: 2021-01-29-20-img 
    Select sda - Select the source hard drive                                               .....sda u konkretnom slučaju                        
    skip checking file system 
    skip checking the saved image 
    not encrypt the image enter
    Y (to continue, then press the Enter key to start the imaging process)

    poweroff                                                                                 .....isključimo kljijenta kad se proces završi
</code></pre>

<p>Napomena: Klonirana slika (2021-01-29-20-img) se smešta u /home/partimag na serveru kako je zadano u konfiguraciji
          (pre ponovnog podizanja sistema klijenta, podesiti da se sistem diže sa hard diska)</p>

<hr>

<p>Instaliranje kloniranog sistema sa servera na udaljene računare-klijente:</p>

<p>*Konfiguracija servera (Debian 10 kao server)</p>

<pre><code>sudo dcs                                                                                     .....startujemo clonezillu
    Select all the clients
    clonezilla-start
    restore-disk Restore an image to client disk
    accept the default values OK
    Use the partition table from image OK
    Skip this option OK
    -p poweroff Shutdown client when the clone finishes OK
    Choose the image that you want to restore (source image)                                .....izaberemo ranije kreitanu klon-sliku 2021-01-29-20-img... 
    Choose the target hard drive (destination drive)                                        .....potvrdimo sda u konkretnom slučaju
    multicast multicast restore
    clients+time-to-wait
    2 the number of systems on which you want to restore the image                          .....odredimo broj sistema koje dižemo uz pomoć klon-slike
    300 maximum time to wait...
    enter
    enter
</code></pre>

<p>Nakon konfiguracije dobijamo ispis koji možemo kasnije kopirati i koristiti da izvršimo identično konfigurisanje bez interaktivnog moda:</p>

<p>sudo drbl-ocs -g auto -e1 auto -e2 -r -x -j2 -sc0 -p poweroff &ndash;clients-to-wait 2 &ndash;max-time-to-wait 300 -l en<em>US.UTF-8 startdisk multicast</em>restore 2021-01-29-20-img sda         </p>

<p>*Konfiguracija klijenata i pokretanje instaliranja kloniranog sistema sa servera na klijente (CentOS 7-1 i CentOS 7-2) </p>

<pre><code>PXE Boot enabled in the BIOS                                                             .....podesimo da se klijenti (CentOS 7-1 i CentOS 7-2) podižu sa mreže
ili
VirtualBox -&gt; CentOS 7-1 (i CentOS 7-2) -&gt; Settings -&gt; System -&gt; Boot order: čekirati Network, odčekirati ostalo -&gt; 
           -&gt; Preferences -&gt; Network -&gt; Adds news NAT network -&gt; čekiramo Enable network -&gt; Network name: neta -&gt; Netvork CIDR: 192.168.99.0/24 -&gt;
           -&gt; Network options: čekiramo Supports DHCP Network -&gt; Ok 
           -&gt; Settings -&gt; -&gt; Network -&gt; Attached to: Internal network -&gt; neta -&gt; Promiscuous mode: Alow all -&gt; OK 

VirtualBox -&gt; CentOS 7-1; CentOS 7-2 (odaberemo 2 klijenta) -&gt; Start

Clonezilla: multicast restore -&gt; pokrećemo instalacuju klona ---&gt; nakon instalacije klijent će se isključiti

Napomena: Pre podizanja sistema klijenata, podesiti da se sistemi dižu sa njihovih hard diskova
</code></pre>
</body></html>